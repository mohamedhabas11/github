# storage
# defaults:
# net.core.optmem_max = 20480
# net.core.rmem_default = 212992
# net.core.rmem_max = 212992
# net.core.somaxconn = 128
# net.core.wmem_default = 212992
# net.core.wmem_max = 212992

# net.ipv4.tcp_max_syn_backlog = 1024
# net.ipv4.tcp_max_tw_buckets = 131072
# net.ipv4.tcp_rmem = 4096    87380   6291456
# net.ipv4.tcp_wmem = 4096    16384   4194304
# net.netfilter.nf_conntrack_max = 262144

net.core.optmem_max={{ MiB_8 }}
net.core.rmem_default={{ KiB_256 }}
net.core.rmem_max={{ MiB_8 }}
net.core.somaxconn={{ KiB_64 }}
net.core.wmem_default={{ KiB_256 }}
net.core.wmem_max={{ MiB_8 }}

net.ipv4.tcp_max_syn_backlog={{ KiB_64 }}
net.ipv4.tcp_max_tw_buckets={{ KiB_512 }}
net.ipv4.tcp_rmem={{ KiB_16 }} {{ KiB_256 }} {{ MiB_8 }}
net.ipv4.tcp_wmem={{ KiB_16 }} {{ KiB_256 }} {{ MiB_8 }}
net.netfilter.nf_conntrack_max={{ MiB_2 }}


# defaults:
# net.core.netdev_max_backlog = 1000
# net.core.netdev_budget = 300
# net.ipv4.tcp_fin_timeout = 60
# net.ipv4.ip_local_port_range = 32768	60999
# 
#
#
# @see https://access.redhat.com/solutions/1241943
# @see https://access.redhat.com/articles/1391433
# for i in {1..30}; do date; cat /proc/net/softnet_stat; sleep 1; done

net.core.netdev_max_backlog={{ KiB_64 }}
net.core.netdev_budget=900

net.ipv4.tcp_fin_timeout = 7
net.ipv4.ip_local_port_range=10240 65535
